"use strict";(self.webpackChunkchat=self.webpackChunkchat||[]).push([[814],{39814:function(e,n,t){t.r(n),t.d(n,{Conversation:function(){return N},default:function(){return ee}});var i=t(57829),r=t(35898),o=t(47313),s=t(19860),a=t(62677),c=t(70885),l=t(17592),d=t(45064),u=t(48119),x=t(61113),p=t(47131),h=t(19536),m=t(24064),g=t(32530),f=t(95765),j=t(66475),Z=(t(32280),t(67250)),b=t(1650),v=t(85554),k=t(65089),y=t(51621),w=t(28477),C=t(79026),F=t(57983),_=t(46417),R=(0,l.ZP)(d.Z)((function(e){var n=e.theme;return{"& .MuiBadge-badge":{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(n.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}})),I=[{title:"Contact info"},{title:"Mute notifications"},{title:"Clear messages"},{title:"Delete chat"}],S=function(){var e=(0,v.I0)(),n=(0,Z.Z)("between","md","xs","sm"),t=(0,s.Z)(),a=(0,v.v9)((function(e){return e.conversation.direct_chat})).current_conversation,l=o.useState(null),d=(0,c.Z)(l,2),S=d[0],z=d[1],P=Boolean(S),T=function(){z(null)};return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(i.Z,{p:2,width:"100%",sx:{backgroundColor:"light"===t.palette.mode?"#F8FAFF":t.palette.background,boxShadow:"0px 0px 2px rgba(0, 0, 0, 0.25)"},children:(0,_.jsxs)(r.Z,{alignItems:"center",direction:"row",sx:{width:"100%",height:"100%"},justifyContent:"space-between",children:[(0,_.jsxs)(r.Z,{onClick:function(){e((0,b.Xk)())},spacing:2,direction:"row",children:[(0,_.jsx)(i.Z,{children:(0,_.jsx)(R,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:(0,_.jsx)(u.Z,{alt:null===a||void 0===a?void 0:a.name,src:null===a||void 0===a?void 0:a.img})})}),(0,_.jsxs)(r.Z,{spacing:.2,children:[(0,_.jsx)(x.Z,{variant:"subtitle2",children:null===a||void 0===a?void 0:a.name}),(0,_.jsx)(x.Z,{variant:"caption",children:"Online"})]})]}),(0,_.jsxs)(r.Z,{direction:"row",alignItems:"center",spacing:n?1:3,children:[(0,_.jsx)(p.Z,{onClick:function(){e((0,y.a8)(a.user_id))},children:(0,_.jsx)(C.Z,{})}),(0,_.jsx)(p.Z,{onClick:function(){e((0,k.Vf)(a.user_id))},children:(0,_.jsx)(w.Z,{})}),!n&&(0,_.jsx)(p.Z,{children:(0,_.jsx)(F.Z,{})}),(0,_.jsx)(h.Z,{orientation:"vertical",flexItem:!0}),(0,_.jsx)(p.Z,{id:"conversation-positioned-button","aria-controls":P?"conversation-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":P?"true":void 0,onClick:function(e){z(e.currentTarget)},children:(0,_.jsx)(j.Z,{})}),(0,_.jsx)(m.Z,{MenuListProps:{"aria-labelledby":"fade-button"},TransitionComponent:g.Z,id:"conversation-positioned-menu","aria-labelledby":"conversation-positioned-button",anchorEl:S,open:P,onClose:T,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,_.jsx)(i.Z,{p:1,children:(0,_.jsx)(r.Z,{spacing:1,children:I.map((function(e){return(0,_.jsxs)(f.Z,{onClick:T,children:[(0,_.jsx)(r.Z,{sx:{minWidth:100},direction:"row",alignItems:"center",justifyContent:"space-between",children:(0,_.jsx)("span",{children:e.title})})," "]})}))})})})]})]})})})},z=t(204),P=t(61689),T=t(42420),L=t(41727),q=t(41938),E=t(82940),M=t(70651),A=t(34041),B=t(75068),O=t(67260),V=t(26343),W=t(26638),H=t(31565),D=t(77580),G=t(83822),Q=(0,l.ZP)(z.Z)((function(e){e.theme;return{"& .MuiInputBase-input":{paddingTop:"12px !important",paddingBottom:"12px !important"}}})),Y=[{color:"#4da5fe",icon:(0,_.jsx)(q.Z,{size:24}),y:102,title:"Photo/Video"},{color:"#1b8cfe",icon:(0,_.jsx)(E.Z,{size:24}),y:172,title:"Stickers"},{color:"#0172e4",icon:(0,_.jsx)(M.Z,{size:24}),y:242,title:"Image"},{color:"#0159b2",icon:(0,_.jsx)(A.Z,{size:24}),y:312,title:"Document"},{color:"#013f7f",icon:(0,_.jsx)(B.Z,{size:24}),y:382,title:"Contact"}],U=function(e){var n=e.openPicker,t=e.setOpenPicker,i=e.setValue,s=e.value,a=e.inputRef,l=o.useState(!1),d=(0,c.Z)(l,2),u=d[0],x=d[1];return(0,_.jsx)(Q,{inputRef:a,value:s,onChange:function(e){i(e.target.value)},fullWidth:!0,placeholder:"Write a message...",variant:"filled",InputProps:{disableUnderline:!0,startAdornment:(0,_.jsxs)(r.Z,{sx:{width:"max-content"},children:[(0,_.jsx)(r.Z,{sx:{position:"relative",display:u?"inline-block":"none"},children:Y.map((function(e){return(0,_.jsx)(P.Z,{placement:"right",title:e.title,children:(0,_.jsx)(T.Z,{onClick:function(){x(!u)},sx:{position:"absolute",top:-e.y,backgroundColor:e.color},"aria-label":"add",children:e.icon})})}))}),(0,_.jsx)(L.Z,{children:(0,_.jsx)(p.Z,{onClick:function(){x(!u)},children:(0,_.jsx)(O.Z,{})})})]}),endAdornment:(0,_.jsx)(r.Z,{sx:{position:"relative"},children:(0,_.jsx)(L.Z,{children:(0,_.jsx)(p.Z,{onClick:function(){t(!n)},children:(0,_.jsx)(G.Z,{})})})})}})};function X(e){return/(https?:\/\/[^\s]+)/g.test(e)}var $=function(){var e=(0,s.Z)(),n=(0,v.v9)((function(e){return e.conversation.direct_chat})).current_conversation,t=window.localStorage.getItem("user_id"),a=(0,Z.Z)("between","md","xs","sm"),l=(0,v.v9)((function(e){return e.app})),d=l.sideBar,u=l.room_id,x=o.useState(!1),h=(0,c.Z)(x,2),m=h[0],g=h[1],f=(0,o.useState)(""),j=(0,c.Z)(f,2),b=j[0],k=j[1],y=(0,o.useRef)(null);return(0,_.jsx)(i.Z,{sx:{position:"relative",backgroundColor:"transparent !important"},children:(0,_.jsx)(i.Z,{p:a?1:2,width:"100%",sx:{backgroundColor:"light"===e.palette.mode?"#F8FAFF":e.palette.background,boxShadow:"0px 0px 2px rgba(0, 0, 0, 0.25)"},children:(0,_.jsxs)(r.Z,{direction:"row",alignItems:"center",spacing:a?1:3,children:[(0,_.jsxs)(r.Z,{sx:{width:"100%"},children:[(0,_.jsx)(i.Z,{style:{zIndex:10,position:"fixed",display:m?"inline":"none",bottom:81,right:a?20:d.open?420:100},children:(0,_.jsx)(H.Z,{theme:e.palette.mode,data:W,onEmojiSelect:function(e){!function(e){var n=y.current;if(n){var t=n.selectionStart,i=n.selectionEnd;k(b.substring(0,t)+e+b.substring(i)),n.selectionStart=n.selectionEnd=t+1}}(e.native)}})}),(0,_.jsx)(U,{inputRef:y,value:b,setValue:k,openPicker:m,setOpenPicker:g})]}),(0,_.jsx)(i.Z,{sx:{height:48,width:48,backgroundColor:e.palette.primary.main,borderRadius:1.5},children:(0,_.jsx)(r.Z,{sx:{height:"100%"},alignItems:"center",justifyContent:"center",children:(0,_.jsx)(p.Z,{onClick:function(){var e;D.W.emit("text_message",{message:(e=b,e.replace(/(https?:\/\/[^\s]+)/g,(function(e){return'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")}))),conversation_id:u,from:t,to:n.user_id,type:X(b)?"Link":"Text"})},children:(0,_.jsx)(V.Z,{color:"#ffffff"})})})})]})})})},J=(t(10019),t(29298)),K=t(14275),N=function(e){var n=e.isMobile,t=e.menu,s=(0,v.I0)(),a=(0,v.v9)((function(e){return e.conversation.direct_chat})),c=a.conversations,l=a.current_messages,d=(0,v.v9)((function(e){return e.app})).room_id;return(0,o.useEffect)((function(){var e=c.find((function(e){return(null===e||void 0===e?void 0:e.id)===d}));D.W.emit("get_messages",{conversation_id:null===e||void 0===e?void 0:e.id},(function(e){console.log(e,"List of messages"),s((0,K.R$)({messages:e}))})),s((0,K.Aq)(e))}),[]),(0,_.jsx)(i.Z,{p:n?1:3,children:(0,_.jsx)(r.Z,{spacing:3,children:l.map((function(e,n){switch(e.type){case"divider":return(0,_.jsx)(J.TY,{el:e});case"msg":switch(e.subtype){case"img":return(0,_.jsx)(J.y1,{el:e,menu:t});case"doc":return(0,_.jsx)(J.RL,{el:e,menu:t});case"Link":return(0,_.jsx)(J.V5,{el:e,menu:t});case"reply":return(0,_.jsx)(J.Q8,{el:e,menu:t});default:return(0,_.jsx)(J.w8,{el:e,menu:t})}default:return(0,_.jsx)(_.Fragment,{})}}))})})},ee=function(){var e=(0,Z.Z)("between","md","xs","sm"),n=(0,s.Z)(),t=(0,o.useRef)(null),c=(0,v.v9)((function(e){return e.conversation.direct_chat})).current_messages;return(0,o.useEffect)((function(){t.current.scrollTop=t.current.scrollHeight}),[c]),(0,_.jsxs)(r.Z,{height:"100%",maxHeight:"100vh",width:e?"100vw":"auto",children:[(0,_.jsx)(S,{}),(0,_.jsx)(i.Z,{ref:t,width:"100%",sx:{position:"relative",flexGrow:1,overflow:"scroll",backgroundColor:"light"===n.palette.mode?"#F0F4FA":n.palette.background,boxShadow:"0px 0px 2px rgba(0, 0, 0, 0.25)"},children:(0,_.jsx)(a.l,{timeout:500,clickOnTrack:!1,children:(0,_.jsx)(N,{menu:!0,isMobile:e})})}),(0,_.jsx)($,{})]})}},29298:function(e,n,t){t.d(n,{Q8:function(){return C},RL:function(){return y},TY:function(){return F},V5:function(){return w},w8:function(){return v},y1:function(){return k}});var i=t(70885),r=t(47313),o=t(24064),s=t(35898),a=t(95765),c=t(57829),l=t(61113),d=t(47131),u=t(19536),x=t(19860),p=t(17551),h=t(16121),m=t(41938),g=t(69963),f=t(10019),j=(t(53522),t(52075)),Z=t(46417),b=function(){var e=r.useState(null),n=(0,i.Z)(e,2),t=n[0],c=n[1],l=Boolean(t),d=function(){c(null)};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(h.Z,{size:20,id:"basic-button","aria-controls":l?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":l?"true":void 0,onClick:function(e){c(e.currentTarget)}}),(0,Z.jsx)(o.Z,{id:"basic-menu",anchorEl:t,open:l,onClose:d,MenuListProps:{"aria-labelledby":"basic-button"},children:(0,Z.jsx)(s.Z,{spacing:1,px:1,children:f.GF.map((function(e){return(0,Z.jsx)(a.Z,{onClick:d,children:e.title})}))})})]})},v=function(e){var n=e.el,t=e.menu,i=(0,x.Z)();return(0,Z.jsxs)(s.Z,{direction:"row",justifyContent:n.incoming?"start":"end",children:[(0,Z.jsx)(c.Z,{px:1.5,py:1.5,sx:{backgroundColor:n.incoming?(0,p.Fq)(i.palette.background.default,1):i.palette.primary.main,borderRadius:1.5,width:"max-content"},children:(0,Z.jsx)(l.Z,{variant:"body2",color:n.incoming?i.palette.text:"#fff",children:n.message})}),t&&(0,Z.jsx)(b,{})]})},k=function(e){var n=e.el,t=e.menu,i=(0,x.Z)();return(0,Z.jsxs)(s.Z,{direction:"row",justifyContent:n.incoming?"start":"end",children:[(0,Z.jsx)(c.Z,{px:1.5,py:1.5,sx:{backgroundColor:n.incoming?(0,p.Fq)(i.palette.background.default,1):i.palette.primary.main,borderRadius:1.5,width:"max-content"},children:(0,Z.jsxs)(s.Z,{spacing:1,children:[(0,Z.jsx)("img",{src:n.img,alt:n.message,style:{maxHeight:210,borderRadius:"10px"}}),(0,Z.jsx)(l.Z,{variant:"body2",color:n.incoming?i.palette.text:"#fff",children:n.message})]})}),t&&(0,Z.jsx)(b,{})]})},y=function(e){var n=e.el,t=e.menu,i=(0,x.Z)();return(0,Z.jsxs)(s.Z,{direction:"row",justifyContent:n.incoming?"start":"end",children:[(0,Z.jsx)(c.Z,{px:1.5,py:1.5,sx:{backgroundColor:n.incoming?(0,p.Fq)(i.palette.background.default,1):i.palette.primary.main,borderRadius:1.5,width:"max-content"},children:(0,Z.jsxs)(s.Z,{spacing:2,children:[(0,Z.jsxs)(s.Z,{p:2,direction:"row",spacing:3,alignItems:"center",sx:{backgroundColor:i.palette.background.paper,borderRadius:1},children:[(0,Z.jsx)(m.Z,{size:48}),(0,Z.jsx)(l.Z,{variant:"caption",children:"Abstract.png"}),(0,Z.jsx)(d.Z,{children:(0,Z.jsx)(g.Z,{})})]}),(0,Z.jsx)(l.Z,{variant:"body2",color:n.incoming?i.palette.text:"#fff",children:n.message})]})}),t&&(0,Z.jsx)(b,{})]})},w=function(e){var n=e.el,t=e.menu,i=(0,x.Z)();return(0,Z.jsxs)(s.Z,{direction:"row",justifyContent:n.incoming?"start":"end",children:[(0,Z.jsx)(c.Z,{px:1.5,py:1.5,sx:{backgroundColor:n.incoming?(0,p.Fq)(i.palette.background.default,1):i.palette.primary.main,borderRadius:1.5,width:"max-content"},children:(0,Z.jsxs)(s.Z,{spacing:2,children:[(0,Z.jsx)(s.Z,{p:2,direction:"column",spacing:3,alignItems:"start",sx:{backgroundColor:i.palette.background.paper,borderRadius:1},children:(0,Z.jsx)(s.Z,{direction:"column",spacing:2,children:(0,Z.jsx)(j.Z,{width:"300px",isDark:!0,url:"https://youtu.be/xoWxBR34qLE"})})}),(0,Z.jsx)(l.Z,{variant:"body2",color:n.incoming?i.palette.text:"#fff",children:(0,Z.jsx)("div",{dangerouslySetInnerHTML:{__html:n.message}})})]})}),t&&(0,Z.jsx)(b,{})]})},C=function(e){var n=e.el,t=e.menu,i=(0,x.Z)();return(0,Z.jsxs)(s.Z,{direction:"row",justifyContent:n.incoming?"start":"end",children:[(0,Z.jsx)(c.Z,{px:1.5,py:1.5,sx:{backgroundColor:n.incoming?(0,p.Fq)(i.palette.background.paper,1):i.palette.primary.main,borderRadius:1.5,width:"max-content"},children:(0,Z.jsxs)(s.Z,{spacing:2,children:[(0,Z.jsx)(s.Z,{p:2,direction:"column",spacing:3,alignItems:"center",sx:{backgroundColor:(0,p.Fq)(i.palette.background.paper,1),borderRadius:1},children:(0,Z.jsx)(l.Z,{variant:"body2",color:i.palette.text,children:n.message})}),(0,Z.jsx)(l.Z,{variant:"body2",color:n.incoming?i.palette.text:"#fff",children:n.reply})]})}),t&&(0,Z.jsx)(b,{})]})},F=function(e){var n=e.el,t=(0,x.Z)();return(0,Z.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsx)(u.Z,{width:"46%"}),(0,Z.jsx)(l.Z,{variant:"caption",sx:{color:t.palette.text},children:n.text}),(0,Z.jsx)(u.Z,{width:"46%"})]})}}}]);